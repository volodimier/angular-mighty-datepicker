(function(){angular.module("mightyDatepicker",[]).directive("mightyDatepicker",["$compile",function(e){var t,n;return n='<div class="mighty-picker__wrapper">\n  <button type="button" class="mighty-picker__prev-month"\n    ng-click="moveMonth(-1, $event)">\n    <<\n  </button>\n  <div class="mighty-picker__month"\n    ng-repeat="month in months track by $index">\n    <div class="mighty-picker__month-name" ng-bind="month.name"></div>\n    <table class="mighty-picker-calendar">\n      <tr class="mighty-picker-calendar__days">\n        <th ng-repeat="day in ::month.weeks[1]"\n          class="mighty-picker-calendar__weekday">\n          {{:: day.date.format(\'dd\') }}\n        </th>\n      </tr>\n      <tr ng-repeat="week in month.weeks">\n        <td\n            ng-class=\'{\n              "mighty-picker-calendar__day": day,\n              "mighty-picker-calendar__day--selected": day.selected,\n              "mighty-picker-calendar__day--disabled": day.disabled,\n              "mighty-picker-calendar__day--in-range": day.inRange,\n              "mighty-picker-calendar__day--marked": day.marker,\n              "mighty-picker-calendar__day--highlighted": day.highlighted\n            }\'\n            ng-repeat="day in ::week track by $index" ng-mouseenter="highlight(day, $event)" ng-click="select(day, $event)">\n            <div class="mighty-picker-calendar__day-wrapper">\n              {{:: day.date.date() }}\n            </div>\n            <div class="mighty-picker-calendar__day-marker-wrapper">\n              <div class="mighty-picker-calendar__day-marker"\n                ng-if="day.marker"\n                ng-bind-template="">\n              </div>\n            </div>\n        </td>\n      </tr>\n    </table>\n  </div>\n  <button type="button" class="mighty-picker__next-month"\n    ng-click="moveMonth(1, $event)">\n    >>\n  </button>\n</div>',t={mode:"simple",months:1,start:null,filter:void 0,callback:void 0,markerTemplate:"{{ day.marker }}",template:n,rangePicker:!1},{restrict:"AE",replace:!0,template:'<div class="mighty-picker__holder"></div>',scope:{model:"=ngModel",options:"=",markers:"=",after:"=",before:"=",rangeFrom:"=",rangeTo:"="},link:function(n,o,a){var r,i,m,d,l,s,c,p,h,f,u,g;switch(r=function(){var t;return t=e(angular.element(n.options.template))(n),o.append(t)},c=function(e,t,n){var o,a;for(o in e)if(a=e[o],t.isSame(a,n))return o;return-1},s=function(){var e;if(n.markers)return n.markerIndex=function(){var t,o,a,r;for(r=[],t=0,o=(a=n.markers).length;t<o;t++)e=a[t],r.push(e.day);return r}()},g=function(e,t){var o;return o=!0,n.before&&o&&(o=e.isSameOrBefore(n.before,"day")),n.after&&o&&(o=e.isSameOrAfter(n.after,"day")),o},l=function(e){var t;return(t=c(n.markerIndex,e,"day"))>-1?n.markers[t].marker:void 0},h=function(e){switch(n.options.mode){case"multiple":return c(n.model,e,"day")>-1;default:return n.model&&e.isSame(n.model,"day")}},p=function(e){return n.options.rangeMode?"from"===n.options.rangeMode?moment.range(n.model,n.before).contains(e)||e.isSame(n.before,"day"):moment.range(n.after,n.model).contains(e)||e.isSame(n.after,"day"):!(!n.options.rangePicker||2!==n.model.length)&&moment.range(n.model[0],n.model[1]).contains(e)},d=function(e,t){var o,a;return[],o=!0,a=e.startOf("week"),[0,1,2,3,4,5,6].map(function(e){var r,i,m;return r=moment(a).add(e,"days"),m=r.month()===t,i=g(r),n.options.filter&&(o=n.options.filter(r)),{date:r,selected:h(r)&&m,inRange:p(r),disabled:!(i&&m&&o),marker:m?l(r):void 0,highlighted:!1}})},m=function(e){var t,n,o;return o=[],moment(e).startOf("month"),moment(e).endOf("month"),5,t=e.startOf("month"),o=function(){var e,o;for(o=[],n=e=0;e<=5;n=++e)o.push(d(moment(t).add(n,"weeks"),moment(t).month()));return o}(),{weeks:o,name:e.format("MMMM YYYY")}},u=function(){var e,o,a,r,i,m;r={};for(e in t)i=t[e],r[e]=i;if(n.options){m=n.options;for(e in m)i=m[e],r[e]=n.options[e]}switch(n.options=r,n.options.mode){case"multiple":n.model&&Array.isArray(n.model)&&n.model.length>0?1===n.model.length?a=moment(n.model[0]):(o=n.model.slice(0),a=moment(o.sort().slice(-1)[0])):n.model=[];break;default:n.model&&(a=moment(n.model))}return n.options.start=n.options.start||a||moment().startOf("day"),n.rangeFrom?n.options.rangeMode="from":n.rangeTo&&(n.options.rangeMode="to"),s(),n.options.template=n.options.template.replace('ng-bind-template=""','ng-bind-template="'+n.options.markerTemplate+'"')},f=function(){var e;return n.months=[],n.months=function(){var t,o,a;for(a=[],e=t=0,o=n.options.months;0<=o?t<o:t>o;e=0<=o?++t:--t)a.push(m(moment(n.options.start).add(e,"months")));return a}()},i=function(){return f(),r()},n.moveMonth=function(e,t){null!=t&&"function"==typeof t.stopPropagation&&t.stopPropagation(),n.options.start.add(e,"month"),f()},n.select=function(e,t){var o;if(null!=t&&"function"==typeof t.stopPropagation&&t.stopPropagation(),!e.disabled){switch(n.options.mode){case"multiple":if(e.selected?(o=c(n.model,e.date,"day"),n.model.splice(o,1)):n.model.length<2?n.model.push(moment(e.date)):moment(e.date).isAfter(n.model[1])?n.model.splice(1,1,moment(e.date)):moment(e.date).isBefore(n.model[0])?n.model.splice(0,1,moment(e.date)):moment(e.date).isBetween(n.model[0],n.model[1])&&n.model.splice(0,1,moment(e.date)),2===n.model.length&&moment(n.model[0]).isAfter(n.model[1])){var a=n.model[0];n.model[0]=n.model[1],n.model[1]=a}break;default:n.model=e.date}return n.options.callback&&n.options.callback(e.date),f()}},n.highlight=function(e,t){if(1===n.model.length&&!e.disabled)n.months[0].weeks.concat(n.months[1].weeks).map(function(t){t.map(function(t){_isHighlited(e,t)})})},_isHighlited=function(e,t){!moment.range(n.model[0],e.date).contains(t.date)||moment(n.model[0]).isSame(t.date,"day")||t.disabled?t.highlighted=!1:t.highlighted=!0},n.$watchCollection("markers",function(e,t){return s(),f()}),u(),i(),n.options.mode){case"multiple":n.$watchCollection("model",function(e,t){return f()});break;case"simple":n.$watch("model",function(e,t){if(moment.isMoment(e)||(e=moment(e)),!t||t&&!e.isSame(t,"day"))return n.model=e,t&&(n.options.start=moment(e)),f()})}return n.$watch("before",function(e,t){if(e&&(moment.isMoment(e)||(e=moment(e)),!e.isSame(t,"day")))return f()}),n.$watch("after",function(e,t){if(e&&(moment.isMoment(e)||(e=moment(e)),!e.isSame(t,"day")))return f()})}}}])}).call(this);